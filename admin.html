<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Rb Admin</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-SgOJa3DmI69IUzQ2PVdRZhwQ+dy64/BUtbMJw1MZ8t5HZApcHrRKUc4W0kG879m7" crossorigin="anonymous">
  <script src="https://code.jquery.com/jquery-3.7.1.js" integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4="
    crossorigin="anonymous"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Anuphan:wght@100..700&family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
    rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
 
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.28/jspdf.plugin.autotable.min.js"></script>
  <link rel="stylesheet" href="Dashboard.html">
</head>
<style>

body{
  max-height: 800px;
}

.b-example-divider {
  width: 100%;
  height: 4rem;
  background-color: rgba(0, 0, 0, .1);
  border: solid rgba(0, 0, 0, .15);
  border-width: 1px 0;
  box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
}
.main-container {
  height: 100vh;
  display: flex;
  border: 2px solid #000;
}


.sidebar {
  width: 20%;
  border-right: 2px solid #000;
  padding: 1rem;
}

.container-sm {
  width: 100%;
  min-height: 18cm;
  max-height: 18cm;
  
 
}

.top-bar {
  height: 50%;
  border-bottom: 2px solid #000;
  padding: 1rem;
}



.btn-container {
  width: 100%;
  margin: 0 auto;
  text-align: center;
}

.bordered {
  border: 2px solid #000;
}

.nav-menu {
  display: block;
  color:rgb(2, 24, 2);
  font-family: "sarabun";
  line-height: 1.5;
}
.row{
  min-height: 1000px;
  max-height: 1000px;
}


.fl-table {
  border-radius: 10px;
  font-size: 12px;
  font-weight: normal;
  border: none;
  background-color: #f8f8f8;
  min-width: 100%;
  max-width: 100%;
  position: relative; 
 
  #downloadExce, #dowload                                                                                                                                           
 
}

.fl-table td, .fl-table th {
  text-align: center;
  padding: 8px;
}

.fl-table tr {
 
  border: 5px solid #f8f8f8;
  border-radius: 10px solid #f8f8f8;
  font-size: 12px;
  font-family: "sarabun";
  background-color: rgba(143, 225, 240, 0.966);
}

.fl-table td:first-child {
  border-top-left-radius: 15px;
  border-bottom-left-radius: 15px;
}

.fl-table td:last-child {
  border-top-right-radius: 15px;
  border-bottom-right-radius: 15px;
}


.midtext{
  left: 50px;
  line-height: 0.5;
}

.table-wrapper {
  max-height: 400px;     /* ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏π‡∏á‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡∏Ç‡∏≠‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á */
  overflow-y: auto;      /* ‡πÉ‡∏´‡πâ‡πÄ‡∏•‡∏∑‡πà‡∏≠‡∏ô‡πÅ‡∏Ñ‡πà‡πÅ‡∏ô‡∏ß‡∏ï‡∏±‡πâ‡∏á */
  overflow-x: auto;      /* ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏•‡πâ‡∏ô */
  position: relative;    /* ‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç‡∏°‡∏≤‡∏Å‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö sticky */
}

.fl-table thead{

    position: sticky;
    
    top: 0;
 
    background-color: #DCDCDC;
   
    z-index: 10;
   
}

.fl-table thead th {
  color: #e9ecee;
  height: 100%;
  position: sticky;
  border: none;
  background-color: rgb(102, 104, 107);   
  z-index: 4000; 
                 
  
}



.logotext{
  color: darkorange;
  font-family: "sarabun";
  font-size: 1rem;
}

.modal,
.modal-bg {
width: 100%;
height: 100%;
background: rgba(0, 0, 0, 0.5);
position: fixed;
top: 0;
left: 0;
display: flex;
justify-content: center;
align-items: center;
}
.modal-page {
z-index: 99;
min-width: 400px;
max-width: 400px;
max-height: 30vw;
overflow: scroll;
background: #fff;
border-radius: 15px;
padding: 20px;
}
    
</style>


<body>
<div class="container"> 
  <div class="container-lg">
    <header class="d-flex flex-wrap align-items-center justify-content-between py-3 mb-4 border-bottom nav-container container">
           
       
      <div class="collapse navbar-collapse d-md-flex justify-content-end" id="navbarNav">
          <ul class="nav nav-pills">
             <li class="nav-item"><a href="login.html" class="nav-link active">Log Out</a></li>
            
                      
          </ul>
      </div>
  </header>
  <div class="b-example-divider" style="justify-content: center;"></div>
  <div class="container-sm"> 
   <div class="row mt-1">
    
      <div class="col-2">
        <div class=".nav-menu ">
          <a href="admin.html">BMI Calculate</a><br>
          <a class="mt-5" href="Dashboard.html">Grip Strengt.</a><br>
          <a class="mt-5" href="legs.html" active>Legs Strengt.</a><br>
          <a class="mt-5"href="back.html" active>Back Strengt.</a><br>
        </div>

      </div>

   
     <div class="col-9 ms-1 mt-5">
        <div style="font-family: sarabun; display: flex;">

          <div class="col-3 ms-3 mb-5">
            <label for="fileInput">‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏ü‡∏•‡πå</label>
            <input class="form-control form-control-sm mt-1" type="file" id="fileInput" accept=".xlsx, .xls">
          </div>

          <div class="col-6  mt-4">
            <button id="importBtn" class="btn btn-primary ms-1 py-1">Import</button>
          </div>

          <div class="col-2  mt-4">
            <div class="btn-group ms-4">
          <button id="downloadExcel" class="btn btn-outline-secondary">Download Excel</button>
         
        
          <button id="downloadPDF" class="btn btn-secondary">Download PDF</button>
          </div>
        </div>
        </div>


        <!-- Data Table -->
    

          <table id="datatest" class="fl-table">
            <thead>
              <tr>
                <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                <th>‡∏£‡∏´‡∏±‡∏™‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                <th>‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                <th>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å.‡∏Å.)</th>
                <th>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã.‡∏°.)</th>
                <th>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏°.)</th>
                <th>BMI</th>
                <th>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
          <div class="table-wrapper">
            <table id="dataTable" class="fl-table">
              <thead style="display: none;">
                <tr>
                  <th>‡∏•‡∏≥‡∏î‡∏±‡∏ö</th>
                  <th>‡∏£‡∏´‡∏±‡∏™‡∏•‡∏á‡∏ó‡∏∞‡πÄ‡∏ö‡∏µ‡∏¢‡∏ô</th>
                  <th>‡∏ä‡∏∑‡πà‡∏≠ ‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•</th>
                  <th>‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å (‡∏Å.‡∏Å.)</th>
                  <th>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏ã.‡∏°.)</th>
                  <th>‡∏™‡πà‡∏ß‡∏ô‡∏™‡∏π‡∏á (‡∏°.)</th>
                  <th>BMI</th>
                  <th>‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏ï‡∏£‡∏ß‡∏à</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
   
  
  <div class="b-example-divider" style="justify-content: center;"></div>
</div>
</div>
  <script>

    // üëâ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel
document.getElementById("downloadExcel").addEventListener("click", function () {
  const table = document.getElementById("dataTable");
  const wb = XLSX.utils.book_new();
  const ws = XLSX.utils.table_to_sheet(table);
  XLSX.utils.book_append_sheet(wb, ws, "Sheet1");
  XLSX.writeFile(wb, "‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û.xlsx");
});

// üëâ ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î PDF
document.getElementById("downloadPDF").addEventListener("click", function () {
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.setFont("THSarabunNew", "normal"); // ‡∏ñ‡πâ‡∏≤‡∏Ñ‡∏∏‡∏ì‡πÉ‡∏ä‡πâ font ‡πÑ‡∏ó‡∏¢ ‡∏ï‡πâ‡∏≠‡∏á embed ‡πÄ‡∏û‡∏¥‡πà‡∏°

  // ‡πÉ‡∏ä‡πâ autoTable ‡∏™‡∏£‡πâ‡∏≤‡∏á PDF ‡∏à‡∏≤‡∏Å‡∏ï‡∏≤‡∏£‡∏≤‡∏á
  doc.autoTable({
    html: '#dataTable',
    startY: 10,
    styles: { fontSize: 10 },
    headStyles: { fillColor: [41, 128, 185] }, // ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏™‡∏µ‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
    margin: { top: 10 },
  });

  doc.save("‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û.pdf");
});

    let selectedFile;

    document.getElementById('fileInput').addEventListener('change', function (e) {
      selectedFile = e.target.files[0];
    });

    document.getElementById('importBtn').addEventListener('click', function () {
      if (!selectedFile) {
        alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå Excel ‡∏Å‡πà‡∏≠‡∏ô");
        return;
      }

      const reader = new FileReader();
      reader.onload = function (e) {
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, { type: 'array' });

        const sheetName = workbook.SheetNames[0];
        const sheet = workbook.Sheets[sheetName];
        const rows = XLSX.utils.sheet_to_json(sheet, { header: 1 });

        const tableBody = document.querySelector("#dataTable tbody");
        tableBody.innerHTML = "";

        // ‡∏Ç‡πâ‡∏≤‡∏°‡πÅ‡∏ñ‡∏ß‡∏´‡∏±‡∏ß‡∏ï‡∏≤‡∏£‡∏≤‡∏á
        for (let i = 1; i < rows.length; i++) {
          const row = rows[i];

          const no = row[0] || "";
          const regId = row[1] || "";
          const name = row[2] || "";
          const weight = parseFloat(row[3]) || 0;
          const heightCm = parseFloat(row[4]) || 0;
          const heightM = heightCm / 100;

          let bmi = 0;
          if (heightM > 0) {
            bmi = weight / (heightM * heightM);
          }

          const summary = getBMISummary(bmi);

          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${no}</td>
            <td>${regId}</td>
            <td>${name}</td>
            <td>${weight}</td>
            <td>${heightCm}</td>
            <td>${heightM.toFixed(2)}</td>
            <td>${bmi ? bmi.toFixed(2) : ""}</td>
            <td>${summary}</td>
          `;
          tableBody.appendChild(tr);
        }
      };

      reader.readAsArrayBuffer(selectedFile);
    });

    function getBMISummary(bmi) {
      if (bmi === 0) return "";
      if (bmi < 18.5) return "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡∏ô‡πâ‡∏≠‡∏¢‡∏Å‡∏ß‡πà‡∏≤‡∏õ‡∏Å‡∏ï‡∏¥";
      if (bmi <= 25) return "‡∏≠‡∏¢‡∏π‡πà‡πÉ‡∏ô‡πÄ‡∏Å‡∏ì‡∏ë‡πå‡∏õ‡∏Å‡∏ï‡∏¥";
      if (bmi <= 30) return "‡∏ô‡πâ‡∏≥‡∏´‡∏ô‡∏±‡∏Å‡πÄ‡∏Å‡∏¥‡∏ô";
      if (bmi <= 35) return "‡πÇ‡∏£‡∏Ñ‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡πÅ‡∏£‡∏Å";
      return "‡πÇ‡∏£‡∏Ñ‡∏≠‡πâ‡∏ß‡∏ô‡∏£‡∏∞‡∏¢‡∏∞‡∏ó‡∏µ‡πà2";
    }


  </script>


  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.5/dist/js/bootstrap.min.js"
    integrity="sha384-VQqxDN0EQCkWoxt/0vsQvZswzTHUVOImccYmSyhJTp7kGtPed0Qcx8rK9h9YEgx+"
    crossorigin="anonymous"></script>
</body>

</html>
