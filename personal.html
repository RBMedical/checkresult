
<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Thai:wght@100..900&display=swap" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <script src="sweetalert2.min.js"></script>
  <link rel="stylesheet" href="sweetalert2.min.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
    rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="api.js"></script>
</head>

<body>
  <style>
    .body {
      font-family: Sarabun;

    }

    .bd-placeholder-img {
      font-size: 1.125rem;
      text-anchor: middle;
      -webkit-user-select: none;
      -moz-user-select: none;
      user-select: none;
    }

    @media (min-width: 768px) {
      .bd-placeholder-img-lg {
        font-size: 3.5rem;
      }
    }

    .b-example-divider {
      width: 100%;
      height: 3rem;
      background-color: rgba(0, 0, 0, .1);
      border: solid rgba(0, 0, 0, .15);
      border-width: 1px 0;
      box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
    }

    .b-example-vr {
      flex-shrink: 0;
      width: 1.5rem;
      height: 100vh;
    }

    .bi {
      vertical-align: -.125em;
      fill: currentColor;
    }

    .nav-scroller {
      position: relative;
      z-index: 2;
      height: 2.75rem;
      overflow-y: hidden;
    }

    .nav-scroller .nav {
      display: flex;
      flex-wrap: nowrap;
      padding-bottom: 1rem;
      margin-top: -1px;
      overflow-x: auto;
      text-align: center;
      white-space: nowrap;
      -webkit-overflow-scrolling: touch;
    }

    .btn-bd-primary {
      --bd-violet-bg: #712cf9;
      --bd-violet-rgb: 112.520718, 44.062154, 249.437846;

      --bs-btn-font-weight: 600;
      --bs-btn-color: var(--bs-white);
      --bs-btn-bg: var(--bd-violet-bg);
      --bs-btn-border-color: var(--bd-violet-bg);
      --bs-btn-hover-color: var(--bs-white);
      --bs-btn-hover-bg: #6528e0;
      --bs-btn-hover-border-color: #6528e0;
      --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
      --bs-btn-active-color: var(--bs-btn-hover-color);
      --bs-btn-active-bg: #5a23c8;
      --bs-btn-active-border-color: #5a23c8;
    }

    .bd-mode-toggle {
      z-index: 1500;
    }

    .bd-mode-toggle .dropdown-menu .active .bi {
      display: block !important;
    }

    .container-sm {
      display: flex;

    }

    .container-login {
      width: 50%;
      line-height: 6px;

    }

    .container-login-input {
      width: 50%;
      margin: 0 auto;
    }

    .container-data {
      width: 50%;
      background-color: rgb(240, 255, 240);
      font-size: 0.75rem;
      line-height: 6px;
      border: 2px solid black;
      border-radius: 10px;

    }

    .modal-error {
      display: none;
      /* ซ่อน modal ไว้ก่อน จนกว่าจะถูกแสดง */
      position: fixed;
      /* ทำให้ modal อยู่บนสุดตลอดเวลา */
      top: 50%;
      /* จัดให้อยู่กลางหน้าจอ (แนวตั้ง) */
      left: 50%;
      /* จัดให้อยู่กลางหน้าจอ (แนวนอน) */
      transform: translate(-50%, -50%);
      /* ย้าย modal ให้ตรงกลางพอดี */
      width: 30%;
      /* กำหนดความกว้าง */
      max-width: 800px;
      /* จำกัดความกว้างสูงสุด */
      padding: 20px;
      /* ระยะห่างด้านในของ modal */

      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      /* เงาของ modal */
      z-index: 1000;
      /* ทำให้ modal อยู่เหนือ element อื่นๆ */
      border-radius: 10px;
      /* มุมโค้งของ modal */
      justify-content: center;
    }
   .line{
     border-color: black;
     background-color: rgb(100, 98, 98);
       }

    @media print {
      .page {
        margin: 0;
        border: initial;
        border-radius: initial;
        width: initial;
        min-height: initial;
        box-shadow: initial;
        background: initial;
        page-break-after: always;
        padding-top: 20%;
      }

      .noprint {
        display: none;
      }

      .container {
        font-size: 0.75rem;
      }

      .container-sm {
        display: flex;
        flex-direction: column;
      }
      .container-login{
        width: 100%;
      }
      .container-data{
        width: 100%;
        border-radius: 0px;
        border: none;
      }
      .container-hidden{
        width: 100%;
        border-radius: none;
        
        border: none;
      }
        .table-hidden{
          border-radius: none;
        
        }
      
    }

    @media (max-width: 576px) {

      .container {
        font-size: 0.75rem;
      }

      body {
        font-size: 0.75rem;

      }

      .col-form-label {
        font-size: 0.75rem;
      }

      .row {
        font-size: 0.75rem;
      }

      .col-auto {
        font-size: 0.75rem;
      }

      .container-sm {

        display: flex;
        flex-direction: column;
      }

      .container-login {
        width: 100%;
        line-height: 2px;

      }
      

      .container-data {
        width: 100%;
        line-height: 2px;
        font-size: 0.5rem;
      }

      .nav-item {
        width: 70%;

      }

      .col-12 {
        font-size: 1rem;
      }

      .btn-primary {
        width: 45%;
      }
      .container-hidden {
        font-size: 0.5rem;
      }
    }

    .modalrecieve {
      display: none;
      /* ซ่อน modal ไว้ก่อน จนกว่าจะถูกแสดง */
      position: fixed;
      /* ทำให้ modal อยู่บนสุดตลอดเวลา */
      top: 50%;
      /* จัดให้อยู่กลางหน้าจอ (แนวตั้ง) */
      left: 50%;
      /* จัดให้อยู่กลางหน้าจอ (แนวนอน) */
      transform: translate(-50%, -50%);
      /* ย้าย modal ให้ตรงกลางพอดี */
      width: 100%;
      /* กำหนดความกว้าง */
      max-width: 1000px;
      /* จำกัดความกว้างสูงสุด */
      background-color: rgb(240, 248, 255);
      /* สีพื้นหลังของ modal */
      padding: 20px;
      /* ระยะห่างด้านในของ modal */
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      /* เงาของ modal */
      z-index: 1000;
      /* ทำให้ modal อยู่เหนือ element อื่นๆ */
      border-radius: 10px;
      /* มุมโค้งของ modal */
    }

    .table-hidden {

      width: 100%;
      font-size: 0.75rem;
     
      line-height: 16px;

    }

    .container-hidden {
      min-width: 100%;
      background-color: #FFFFCC;
      font-size: 0.75rem;
      line-height: 4px;
      border: 2px solid black;
      border-radius: 10px;
      margin-left: 30px;
      display: none;
      box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
      z-index: 1000;
    }
  </style>






  <h1 class="visually-hidden">Headers examples</h1>

  <div class="container">
    <header class="justify-content-center py-3 mb-4 border-bottom">
      <a class="align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">

        <div class="col-12 fs-6" style="font-family: sarabun;">ระบบค้นหาผลการตรวจสุขภาพประจำปีทางอินเตอร์เน็ต</div>
        <span id="datetime"></span>
      </a>
      <ul class="nav nav-pills justify-content-end noprint">
       
        <input class="nav-item ms-2 mb-1  text-center" id="searchKey" placeholder="User ID"></input>

        <input class="nav-item  ms-2  mb-1 text-center" id="password" type="password" placeholder="password"></input>
        <button class="nav-item ms-2 btn btn-primary" type="button" onclick="searchRecord()">search</button>
        <button type="button" id="printBtn" onclick="printResult()" class="btn btn-secondary ms-1" disabled>
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-printer"
            viewBox="0 0 16 16">
            <path d="M2.5 8a.5.5 0 1 0 0-1 .5.5 0 0 0 0 1" />
            <path
              d="M5 1a2 2 0 0 0-2 2v2H2a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h1v1a2 2 0 0 0 2 2h6a2 2 0 0 0 2-2v-1h1a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-1V3a2 2 0 0 0-2-2zM4 3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2H4zm1 5a2 2 0 0 0-2 2v1H2a1 1 0 0 1-1-1V7a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3a1 1 0 0 1-1 1h-1v-1a2 2 0 0 0-2-2zm7 2v3a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-3a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1" />
          </svg>
        </button>
        <a href="index.html" class="btn btn-outline-secondary ms-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-house" viewBox="0 0 16 16">
<path d="M8.707 1.5a1 1 0 0 0-1.414 0L.646 8.146a.5.5 0 0 0 .708.708L2 8.207V13.5A1.5 1.5 0 0 0 3.5 15h9a1.5 1.5 0 0 0 1.5-1.5V8.207l.646.647a.5.5 0 0 0 .708-.708L13 5.793V2.5a.5.5 0 0 0-.5-.5h-1a.5.5 0 0 0-.5.5v1.293zM13 7.207V13.5a.5.5 0 0 1-.5.5h-9a.5.5 0 0 1-.5-.5V7.207l5-5z"/>
</svg>
</a>
      </ul>
    </header>
 
  <div id="result">


  </div>

<script>

function searchRecord() {
  var searchKey = document.getElementById('searchKey').value;
  var password = document.getElementById('password').value;

 
  const urlsheet1 = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${rangesheet1}?key=${apiKey}`;
  
 
  fetch(urlsheet1)
    .then(response => response.json())
    .then(data => {
      const resultDiv1 = document.getElementById('result');
      resultDiv1.innerHTML = ''; 

      let found = false;

          data.values.forEach(row => {
            if (row[0] == searchKey && row[66] == password) { 
              resultDiv1.innerHTML +=`
              <div class="container-sm" id="result" style="font-family: sarabun;">
                  <div class="container-login">
     
                       <form id="searchForm" class="container">
                           <div class="row fs-3 align-items-center">
                                      <div class="col-auto">
                                        <label class="col-form-label fw-bold">Identify :</label>
                                       </div>
                                        <div class="col-auto">
                                          <label> ${row[0]}</label>
                                         </div>
                                       </div>
                                        <div class="row fs-3 align-items-center">
                                           <div class="col-auto">
                                             <label class="col-form-label fw-bold ">ชื่อ นามสกุล :</label>
                                          </div>
                                           <div class="col-auto">
                                              <label> ${row[1]}</label>
                                           </div>
                                         <div class="col-10 ms-1 border border-bottom"></div>
                                       </div>

                                       <div class="row align-items-center">
                                           <div class="col-auto">
                                              <label class="col-form-label fw-bold">อายุ :</label>
                                          </div>
                                         <div class="col-auto">
                                           <label> ${row[2]}</label>
                                         </div>
                                         <div class="col-auto">
                                           <label class="col-form-label fw-bold">ปี</label>
                                         </div>
                                       <div class="col-auto">
                                          <label class="col-form-label fw-bold">เพศ</label>
                                       </div>
                                         <div class="col-auto">
                                          <label> ${row[3]}</label>
                                         </div>
                                       
                                       <div class="row  align-items-center">
                                        <div class="col-auto">
                                           <label class="col-form-label fw-bold">น้ำหนัก :</label>
                                        </div>
                                         <div class="col-auto">
                                           <label> ${row[4]}</label>
                                         </div>
                                         <div class="col-auto">
                                           <label class="col-form-label fw-bold">ก.ก.</label>
                                       </div>
                                       <div class="col-auto">
                                          <label class="col-form-label fw-bold">ส่วนสูง</label>
                                       </div>
                                         <div class="col-auto">
                                           <label> ${row[5]}</label>
                                         </div>
                                         <div class="col-auto">
                                          <label class="col-form-label fw-bold">ซ.ม.</label>
                                          </div>
                                      <div class="col-auto">
                                          <label class="col-form-label fw-bold">หมู่โลหิต</label>
                                     </div>
                                        <div class="col-auto">
                                          <label> ${row[6]}</label>
                                         </div>
                                       </div>
                                    
                                        <div class="row align-items-center">
                                            <div class="col-auto">
                                              <label class="col-form-label mt-3 fw-bold">ผลการตรวจสุขภาพทั่วไปโดยแพทย์</label>
                                           </div>
                                         </div>
                                       

                                       <div class="row align-items-center">
                                            <div class="col-auto">
                                               <label class="col-form-label ms-1 fw-bold">ค่าBMI :</label>
                                            </div>
                                             <div class="col-auto">
                                              <label> ${row[9]}</label>
                                           </div>
                                           <div class="col-auto">
                                             <label class="col-form-label fw-bold">อยู่ในเกณฑ์ :</label>
                                           </div>
                                         <div class="col-auto">
                                            <label> ${row[10]}</label>
                                         </div>
                                       </div>
                                       
                                       <div class="row align-items-center">
                                          <div class="col-auto">
                                            <label class="col-form-label ms-1 fw-bold">ค่าความดันโลหิต :</label>
                                         </div>
                                         <div class="col-auto">
                                            <label> ${row[7]}</label>
                                         </div>
                                         <div class="col-auto">
                                          <label class="col-form-label fw-bold">mm.Hg</label>
                                         </div>
                                         <div class="col-auto">
                                           <label class="col-form-label fw-bold">การเต้นของชีพจร :</label>
                                         </div>
                                         <div class="col-auto">
                                          <label> ${row[8]}</label>
                                         </div>
                                          <div class="col-auto">
                                        <label class="col-form-label fw-bold">ครั้ง/นาที</label>
                                         </div>
                                       </div>
                                                                                                                  
                                        <div class="row align-items-center">
                                           <div class="col-auto">
                                             <label class="col-form-label ms-1 fw-bold">ผลการตรวจปัสสาวะทั่วไป :</label>
                                           </div>
                                           <div class="col-auto">
                                             <label> ${row[12]}</label>
                                           </div>
                                            <div class="col-auto">
                                             <label class="text-primary noprint" onclick="openUa()" style="cursor: pointer;">กดดูรายละเอียด</label>
                                           </div>
                                       </div>
                                        <div class="row align-items-center">
                                           <div class="col-auto">
                                             <label class="col-form-label ms-1 fw-bold">ผลการเอ็กซเรย์ทรวงอก (Chest X Ray) :</label>
                                          </div>
                                          <div class="col-auto">
                                           <label> ${row[13]}</label>
                                         </div>
                                       </div>
                                      <div class="row align-items-center">
                                       <div class="col-auto">
                                        <label class="col-form-label ms-1 fw-bold">ความเห็นแพทย์ :</label>
                                        </div>
                                         <div class="col-auto">
                                          <label> ${row[11]}</label>
                                       </div>
                                       </div>
                          
                   
  
  <div class="row align-items-center">
<div class="container-hidden ms-3 mb-3" id="hidden" style="display:none;">
  <table class="table-hidden border-dark mb-5" >
               <thead class="border-bottom" style="border-color: black;">
            <tr>
      <th scope="col" colspan="3"><button  onclick="closehidden()" style="border: hidden;" class="noprint"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-backspace" viewBox="0 0 16 16">
  <path d="M5.83 5.146a.5.5 0 0 0 0 .708L7.975 8l-2.147 2.146a.5.5 0 0 0 .707.708l2.147-2.147 2.146 2.147a.5.5 0 0 0 .707-.708L9.39 8l2.146-2.146a.5.5 0 0 0-.707-.708L8.683 7.293 6.536 5.146a.5.5 0 0 0-.707 0z"/>
  <path d="M13.683 1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7.08a2 2 0 0 1-1.519-.698L.241 8.65a1 1 0 0 1 0-1.302L5.084 1.7A2 2 0 0 1 6.603 1zm-7.08 1a1 1 0 0 0-.76.35L1 8l4.844 5.65a1 1 0 0 0 .759.35h7.08a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
</svg></button>
<p>ค่าความสมบูรณ์ของเม็ดเลือด</p>
</th>
     
      <th scope="col" class="text-center">ค่าที่ได้</th>
      <th scope="col" class="text-center">ค่าปกติ</th>
    </tr>
  </thead>
   <tbody>
    <tr>
      <th scope="row" colspan="2"></th>
      <td>เม็ดเลือดขาว(WBC)</td>
        <td class="text-center">${row[44]}</td> 
        <td class="text-center">5,000-10,000 cell/mL</td> 
    </tr>                              

  <tr>
      <th scope="row" colspan="2"></th>
        <td>Hemogobin</td>
       <td class="text-center">${row[45]}</td> 
       <td class="text-center">13.7-17.5 g/dL</td> 
    </tr>     


<tr>
      <th scope="row" colspan="2"></th>
       <td>Hematocrit</td>
       <td class="text-center">${row[46]}</td> 
       <td class="text-center">40.1-51%</td>
    </tr>     

<tr>
      <th scope="row" colspan="2"></th>
      <td>Neutrophils</td>
        <td class="text-center">${row[47]}</td> 
       <td class="text-center">34-67.9%</td> 
    </tr>     

<tr>
      <th scope="row" colspan="2"></th>
      <td>Lymthocytes</td>
        <td class="text-center">${row[48]}</td>
       <td class="text-center">21.8-53.1%</td> 
    </tr> 

<tr>
      <th scope="row" colspan="2"></th>
      <td>Monocyte</td>
       <td class="text-center">${row[49]}</td> 
       <td class="text-center">5.3-12.2%</td> 
    </tr> 

<tr>
      <th scope="row" colspan="2"></th>
      <td>Eosinphil</td>
       <td class="text-center">${row[50]}</td> 
       <td class="text-center">0.8-7%</td> 
    </tr>  

 <tr>
      <th scope="row" colspan="2"></th>
      <td>Basophill</td>
        <td class="text-center">${row[51]}</td> 
       <td class="text-center">0.2-1.2%</td> 
    </tr>   

  <tr>
      <th scope="row" colspan="2"></th>
      <td>Platlet count</td>
         <td class="text-center">${row[52]}</td>
       <td class="text-center">140,000-400,000 cell/cu.mm</td> 
    </tr> 

  <tr>
      <th scope="row" colspan="2"></th>
      <td>MCV</td>
       <td class="text-center">${row[53]}</td>
       <td class="text-center">80-100 fl</td> 
    </tr>                             
   </tbody>
   </table> 
 </div>
   </div>

 <div class="row align-items-center">
<div class="container-hidden ms-3 mb-3" id="hide" style="background-color: #CCFFFF;">
  <table class="table-hidden border-dark mb-5" >
               <thead class="border-bottom">
            <tr>
      <th scope="col" colspan="3"><button  onclick="closehide()" class="noprint" style="border: hidden;"> <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-backspace" viewBox="0 0 16 16">
  <path d="M5.83 5.146a.5.5 0 0 0 0 .708L7.975 8l-2.147 2.146a.5.5 0 0 0 .707.708l2.147-2.147 2.146 2.147a.5.5 0 0 0 .707-.708L9.39 8l2.146-2.146a.5.5 0 0 0-.707-.708L8.683 7.293 6.536 5.146a.5.5 0 0 0-.707 0z"/>
  <path d="M13.683 1a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2h-7.08a2 2 0 0 1-1.519-.698L.241 8.65a1 1 0 0 1 0-1.302L5.084 1.7A2 2 0 0 1 6.603 1zm-7.08 1a1 1 0 0 0-.76.35L1 8l4.844 5.65a1 1 0 0 0 .759.35h7.08a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
</svg></button>
<p>ผลการตรวจปัสสาวะทั่วไป</p>
</th>
 
      <th scope="col" class="text-center">ค่าที่ได้</th>
      <th scope="col" class="text-center">ค่าปกติ</th>
    </tr>
  </thead>
   <tbody>
    <tr>
      <th scope="row" colspan="2"></th>
      <td>color</td>
        <td class="text-center">${row[54]}</td> 
        <td class="text-center">yellow</td> 
    </tr>                              

  <tr>
      <th scope="row" colspan="2"></th>
        <td>Appearance</td>
       <td class="text-center">${row[55]}</td> 
       <td class="text-center">clear</td> 
    </tr>     


<tr>
      <th scope="row" colspan="2"></th>
       <td>Ph</td>
       <td class="text-center">${row[57]}</td> 
       <td class="text-center">4.5-8</td>
    </tr>     

<tr>
      <th scope="row" colspan="2"></th>
      <td>Specific Gravity</td>
        <td class="text-center">${row[56]}</td> 
       <td class="text-center">1-1.03</td> 
    </tr>     

<tr>
      <th scope="row" colspan="2"></th>
      <td>Protain</td>
        <td class="text-center">${row[58]}</td>
       <td class="text-center">Negative</td> 
    </tr> 

<tr>
      <th scope="row" colspan="2"></th>
      <td>Glucose</td>
       <td class="text-center">${row[59]}</td> 
       <td class="text-center">Negative</td> 
    </tr> 

<tr>
      <th scope="row" colspan="2"></th>
      <td>RBC</td>
       <td class="text-center">${row[60]}</td> 
       <td class="text-center">1-2</td> 
    </tr>  

 <tr>
      <th scope="row" colspan="2"></th>
      <td>WBC</td>
        <td class="text-center">${row[61]}</td> 
       <td class="text-center">0-1</td> 
    </tr>   

  <tr>
      <th scope="row" colspan="2"></th>
      <td>Epithelium</td>
         <td class="text-center">${row[63]}</td>
       <td class="text-center">0-1</td> 
    </tr> 

  <tr>
      <th scope="row" colspan="2"></th>
      <td>Bacteria</td>
       <td class="text-center">${row[62]}</td>
       <td class="text-center">Normal</td> 
    </tr> 

    <tr>
      <th scope="row" colspan="2"></th>
      <td>Amphetamine</td>
       <td class="text-center">${row[64]}</td>
       <td class="text-center">Negative</td> 
    </tr> 
     <tr>
      <th scope="row" colspan="2"></th>
      <td>Pregnancy (การตั้งครรภ์)</td>
       <td class="text-center">${row[65]}</td>
       <td class="text-center">Negative</td> 
    </tr>                                                                     
   </tbody>
   </table> 
 </div>
   </div>

    </form>
   </div>
  </div>

 



  <div class="container-data">
  <div class="row fs-4 align-items-center">
                                           <div class="col-auto">
                                             <label class="col-form-label fs-6 ms-1 fw-bold">ผลตรวจทางห้องปฎิบัติการ</label>
                                           </div>
                                           
                                       </div>
    
     <table class="table border-dark">
  <thead class="table-secondary">
    <tr>
      <th scope="col" colspan="2">รายการตรวจ</th>
      <th scope="col" class="text-center">ผลตรวจ</th>
      <th scope="col" class="text-center">ค่าประมวลผล</th>
    </tr>
  </thead>
   <tbody>
    <tr>
      <th scope="row" colspan="2">ความสมบูรณ์ของเม็ดเลือด</th>   
       <td class="text-center">${row[12]}</td> 
       <td class="text-primary text-center noprint" onclick="openCbc()" style="cursor: pointer;">กดดู</td>
    </tr>
   <tr>
      <th scope="row" colspan="2">ปริมาณน้ำตาลในเลือด</th>  
       <td class="text-center">${row[16]}</td> 
      <td class="text-center">${row[15]}</td>
    </tr> 
   <tr>
      <th scope="row" colspan="4">ปริมาณไขมันในเส้นเลือด</th>
      
    </tr> 
    <tr>
      <th scope="row"></th>
         <td>Cholestroral</td> 
       <td class="text-center">${row[18]}</td> 
      <td class="text-center">${row[17]}</td>
    </tr>
    <tr>
      <th scope="row"></th>
        <td>HDL</td>       
       <td class="text-center">${row[20]}</td> 
       <td class="text-center">${row[19]}</td>
    </tr>
    <tr>
      <th scope="row"></th>
       <td>LDL</td>       
       <td class="text-center">${row[22]}</td>
        <td class="text-center">${row[21]}</td> 
    </tr>
    <tr>
      <th scope="row""></th>
         <td>Trigleceride</td>        
       <td class="text-center">${row[24]}</td> 
       <td class="text-center">${row[23]}</td>
    </tr>
     <tr>
      <th scope="row" colspan="4">การทำงานของตับ</th>
      
    </tr> 
    <tr>
      <th scope="row"></th>
        <td>SGPT/ALT</td>       
       <td class="text-center">${row[26]}</td> 
        <td class="text-center">${row[25]}</td>
    </tr>
  <tr>
      <th scope="row"></th>
        <td>SGOT/AST</td>        
       <td class="text-center">${row[28]}</td> 
       <td class="text-center">${row[27]}</td>
    </tr>
    <tr>
      <th scope="row" colspan="4">การทำงานของไต</th>
     
    </tr> 
   <tr>
      <th scope="row"></th>
         <td>BUN</td>        
       <td class="text-center">${row[30]}</td> 
       <td class="text-center">${row[29]}</td>
    </tr>
  <tr>
      <th scope="row"></th>
         <td>Creatinin</td>        
       <td class="text-center">${row[32]}</td> 
       <td class="text-center">${row[31]}</td>
    </tr>
     <tr>
      <th scope="row" colspan="2">กรดยูริค/เก๊า</th>        
       <td class="text-center">${row[34]}</td> 
       <td class="text-center">${row[33]}</td>
    </tr> 
    <tr>
      <th scope="row" colspan="2">เชื้อไวรัสตับอักเสบ บี</th>       
       <td class="text-center">${row[43]}</td> 
        <td class="text-center">${row[42]}</td>
    </tr> 
   </tbody>
  </table>
     <div class="row fs-4 align-items-center">
                                           <div class="col-auto">
                                             <label class="col-form-label ms-1 fs-6 fw-bold">ผลตรวจทางชีวอนามัย</label>
                                           </div>
                                         </div>
 <table class="table border-dark" >
  <thead class="table-secondary">
    <tr>
      <th scope="col" colspan="3">รายการตรวจ</th>
     <th scope="col"></th>
      <th scope="col" class="text-center">ผลตรวจ</th>
    </tr>
  </thead>
   <tbody>
    <tr>
      <th scope="row" colspan="3">สายตาชีวอนามัย</th>
        <td></td> 
       <td class="text-center">${row[35]}</td> 
    </tr>
   <tr>
      <th scope="row" colspan="3">การได้ยิน</th>
       <td></td> 
       <td class="text-center">${row[36]}</td> 
    </tr> 
   
   <tr>
      <th scope="row" colspan="3">เป่าปอด</th>
       <td></td> 
       <td class="text-center">${row[38]}</td> 
    </tr> 
   <tr>
      <th scope="row" colspan="4">สมรรถภาพทางกล้ามเนื้อ</th>
       
         <td></td> 
    </tr> 
    <tr>
      <th scope="row"></th>
       <td>กล้ามเนื้อมือ</td>
         <td></td>
          
     
        <td></td>
       <td class="text-center">${row[39]}</td> 
    </tr>
    <tr>
     <th scope="row"></th>
        <td>กล้ามเนื้อขา</td>
        <td></td>
        <td></td>
       <td class="text-center">${row[40]}</td> 
    </tr>
    <tr>
     <th scope="row"></th>
        <td>กล้ามเนื้อหลัง</td>
        <td></td>
        <td></td>
       <td class="text-center">${row[41]}</td> 
    </tr>
   
     </tbody>
     </table><div class="row fs-4 align-items-center">
                                         <div class="col-auto">
                                           <label class="col-form-label ms-1 fs-6 fw-bold">ผลตรวจอื่นๆ</label>
                                         </div>
                                       </div>
<table class="table border-dark">
<thead class="table-secondary">
  <tr>
    <th scope="col" colspan="2">รายการตรวจ</th>
   <th scope="col"></th>
    <th scope="col" class="text-center">ค่า</th>
    <th scope="col" class="text-center">ผลตรวจ</th>
  </tr>
</thead>   
     <tbody id="outlab">                               
     
 </tbody>
   </table>
     </div>                                
     </div>
    </div>    
      
      `
      found = true;
      searchOutlab();
      document.getElementById('printBtn').disabled= false;
     
        }
      });
      if (!found) {
        resultDiv1.innerHTML = '<p>user ID หรือ password ไม่ถูกต้อง</p>';
      }
    });



    
}
      
     
 function searchOutlab(){
  var searchKey = document.getElementById('searchKey').value;
 

 
  const urlsheet2 = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${rangesheet2}?key=${apiKey}`;
  

  fetch(urlsheet2)
  .then(response => response.json())
  .then(data => {
    const resultDiv2 = document.getElementById('outlab');
    resultDiv2.innerHTML = ''; 

    let found = false;

    data.values.forEach(row => {
      if (row[0] == searchKey) { 
        resultDiv2.innerHTML += `

  <tr>
    <th scope="row" colspan="3">${row[2]}</th>
      <td class="text-center">${row[3]}</td> 
     <td class="text-center">${row[4]}</td> 
  </tr>
 
 
  

        `;
        found = true;
      }
    });

    if (!found) {
      resultDiv2.innerHTML = '<p>ไม่พบข้อมูลใน Sheet2</p>';
    }
  });
  
 } 
    
    function printResult() {
    
        window.print(); // ใช้คำสั่ง print เพื่อพิมพ์เฉพาะส่วนผลลัพธ์
      }


   
      function openCbc() {
    $('#hidden').css('display', 'flex');
    $('#hide').css('display', 'none')
  
      }
 function openUa() {
    $('#hide').css('display', 'flex');
    $('#hidden').css('display', 'none')
      }
       function closehidden() {
         event.preventDefault();
    $('#hidden').css('display', 'none')
       }

       function closehide() {
         event.preventDefault();
    $('#hide').css('display', 'none')
       }



</script>


  <script src="https://cdn.jsdelivr.net/npm/@Popperjs/core@2.11.8/dist/umd/Popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
    integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
    crossorigin="anonymous"></script>
</body>

</html>
