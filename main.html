<!DOCTYPE html>
<html lang="th">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+Thai:wght@100..900&display=swap" rel="stylesheet">
  <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk="
    crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css"
    integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g=="
    crossorigin="anonymous" referrerpolicy="no-referrer" />

  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/5.1.3/css/bootstrap.min.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <script src="sweetalert2.min.js"></script>
  <link rel="stylesheet" href="sweetalert2.min.css">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Gowun+Batang:wght@400;700&display=swap" rel="stylesheet">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Sarabun:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800&display=swap"
    rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>

  <script src="api.js"></script>
 
</head>
<body>
    <style>
        .body {
          font-family: Sarabun;
    
        }
    
        .bd-placeholder-img {
          font-size: 1.125rem;
          text-anchor: middle;
          -webkit-user-select: none;
          -moz-user-select: none;
          user-select: none;
        }
    
        @media (min-width: 768px) {
          .bd-placeholder-img-lg {
            font-size: 3.5rem;
          }
          #message{
            display: none;
          }
        }
    
        .b-example-divider {
          width: 100%;
          height: 3rem;
          background-color: rgba(0, 0, 0, .1);
          border: solid rgba(0, 0, 0, .15);
          border-width: 1px 0;
          box-shadow: inset 0 .5em 1.5em rgba(0, 0, 0, .1), inset 0 .125em .5em rgba(0, 0, 0, .15);
        }
    
        .b-example-vr {
          flex-shrink: 0;
          width: 1.5rem;
          height: 100vh;
        }
        .container-fluid{
            background-image: "https://img2.pic.in.th/pic/251778975ff14a904c2763f36d5bb42b.png";
        }
      
      
        .bi {
          vertical-align: -.125em;
          fill: currentColor;
        }
    
        .nav-scroller {
          position: relative;
          z-index: 2;
          height: 2.75rem;
          overflow-y: hidden;
        }
    
        .nav-scroller .nav {
          display: flex;
          flex-wrap: nowrap;
          padding-bottom: 1rem;
          margin-top: -1px;
          overflow-x: auto;
          text-align: center;
          white-space: nowrap;
          -webkit-overflow-scrolling: touch;
        }
    
        .btn-bd-primary {
          --bd-violet-bg: #712cf9;
          --bd-violet-rgb: 112.520718, 44.062154, 249.437846;
    
          --bs-btn-font-weight: 600;
          --bs-btn-color: var(--bs-white);
          --bs-btn-bg: var(--bd-violet-bg);
          --bs-btn-border-color: var(--bd-violet-bg);
          --bs-btn-hover-color: var(--bs-white);
          --bs-btn-hover-bg: #6528e0;
          --bs-btn-hover-border-color: #6528e0;
          --bs-btn-focus-shadow-rgb: var(--bd-violet-rgb);
          --bs-btn-active-color: var(--bs-btn-hover-color);
          --bs-btn-active-bg: #5a23c8;
          --bs-btn-active-border-color: #5a23c8;
        }
    
        .bd-mode-toggle {
          z-index: 1500;
        }
    
        .bd-mode-toggle .dropdown-menu .active .bi {
          display: block !important;
        }
    
        .container-sm {
          display: flex;
    
        }
    
        .container-login {
          width: 50%;
          line-height: 6px;
    
        }
    
        .container-login-input {
          width: 50%;
          margin: 0 auto;
        }
    
        .container-data {
          width: 50%;
          background-color: rgb(240, 255, 240);
          font-size: 0.75rem;
          line-height: 6px;
          border: 2px solid black;
          border-radius: 10px;
    
        }
    
        .modal-error {
          display: none;
          /* ซ่อน modal ไว้ก่อน จนกว่าจะถูกแสดง */
          position: fixed;
          /* ทำให้ modal อยู่บนสุดตลอดเวลา */
          top: 50%;
          /* จัดให้อยู่กลางหน้าจอ (แนวตั้ง) */
          left: 50%;
          /* จัดให้อยู่กลางหน้าจอ (แนวนอน) */
          transform: translate(-50%, -50%);
          /* ย้าย modal ให้ตรงกลางพอดี */
          width: 30%;
          /* กำหนดความกว้าง */
          max-width: 800px;
          /* จำกัดความกว้างสูงสุด */
          padding: 20px;
          /* ระยะห่างด้านในของ modal */
    
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
          /* เงาของ modal */
          z-index: 1000;
          /* ทำให้ modal อยู่เหนือ element อื่นๆ */
          border-radius: 10px;
          /* มุมโค้งของ modal */
          justify-content: center;
        }
       .line{
         border-color: black;
         background-color: rgb(100, 98, 98);
           }
    
        @media print {
          .page {
            margin: 0;
            border: initial;
            border-radius: initial;
            width: initial;
            min-height: initial;
            box-shadow: initial;
            background: initial;
            page-break-after: always;
            padding-top: 20%;
          }
    
          .noprint {
            display: none;
          }
    
          .container {
            font-size: 0.75rem;
          }
    
          .container-sm {
            display: flex;
            flex-direction: column;
          }
          .container-login{
            width: 100%;
          }
          .container-data{
            width: 100%;
            border-radius: 0px;
            border: none;
          }
          .container-hidden{
            width: 100%;
            border-radius: none;
            
            border: none;
          }
            .table-hidden{
              border-radius: none;
            
            }
          
        }
    
        @media (max-width: 576px) {
    
          .container {
            font-size: 0.75rem;
          }
    
          body {
            font-size: 0.75rem;
    
          }
    
          .col-form-label {
            font-size: 0.75rem;
          }
    
          .row {
            font-size: 0.75rem;
          }
    
          .col-auto {
            font-size: 0.75rem;
          }
    
          .container-sm {
    
            display: flex;
            flex-direction: column;
          }
    
          .container-login {
            width: 100%;
            line-height: 2px;
    
          }
          
    
          .container-data {
            width: 100%;
            line-height: 2px;
            font-size: 0.5rem;
          }
    
          .nav-item {
            width: 70%;
    
          }
    
          .col-12 {
            font-size: 1rem;
          }
    
          .btn-primary {
            width: 60%;
          }
          .container-hidden {
            font-size: 0.5rem;
          }
          #recieve{
            display: none;
          }
          #message{
            display: block;
          }
        }
    
        .modalrecieve {
       
          /* ซ่อน modal ไว้ก่อน จนกว่าจะถูกแสดง */
          position: fixed;
          /* ทำให้ modal อยู่บนสุดตลอดเวลา */
          top: 50%;
          /* จัดให้อยู่กลางหน้าจอ (แนวตั้ง) */
          left: 50%;
          /* จัดให้อยู่กลางหน้าจอ (แนวนอน) */
          transform: translate(-50%, -50%);
          /* ย้าย modal ให้ตรงกลางพอดี */
          width: 20%;
          /* กำหนดความกว้าง */
        
   
          background-color: rgb(240, 248, 255);
          /* สีพื้นหลังของ modal */
          padding: 20px;
          /* ระยะห่างด้านในของ modal */
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
          /* เงาของ modal */
          z-index: 1000;
          /* ทำให้ modal อยู่เหนือ element อื่นๆ */
          border-radius: 10px;
          /* มุมโค้งของ modal */
        }
    
        .table-hidden {
    
          width: 100%;
          font-size: 0.75rem;
         
          line-height: 16px;
    
        }
    
        .container-hidden {
          min-width: 100%;
          background-color: #FFFFCC;
          font-size: 0.75rem;
          line-height: 4px;
          border: 2px solid black;
          border-radius: 10px;
          margin-left: 30px;
          display: none;
          box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
          z-index: 1000;
        }
        .form-floating{
            height: 70%;
        }
      @media(max-width: 576px){
        .modalrecieve{
          width: 80%;

        }
      }
      </style>

    <main class="form-signin w-100 m-auto">
        <div class="modalrecieve" id="recieve">
        <form>
            <h1 class="h3 mb-3 fw-normal">Please Log In</h1>
    
            <div class="dropdown">
                <select class="form-select" id="dynamicDropdown" aria-label="Dropdown"></select>
            </div>
    
           
                <input type="password" class="form-control text-center mt-2" id="floatingPassword" placeholder="Password">
      
           
    
            <button type="button" id="sub" class="btn btn-primary w-100 py-2 mt-2" onclick="checkCredentials()">Sign in</button>
          <a href="index.html">ปิด</a>
          
        </form>
    </div>
      <div class="modalrecieve" id="message">
        <div class="text-danger">This device not support , Open this page on PC.</div>
      </div>
    </main>
    
    <script>
       
    
        const urlsheet1 = `https://sheets.googleapis.com/v4/spreadsheets/${spreadsheetId}/values/${rangesheet3}?key=${apiKey}`;
    
        let sheetData = []; // เก็บข้อมูลจาก Google Sheets
    
        function loadDropdownData() {
            fetch(urlsheet1)
                .then(response => response.json())
                .then(data => {
                    const dropdown = document.getElementById('dynamicDropdown');
                    dropdown.innerHTML = ''; // Clear previous options
    
                    if (data.values && data.values.length > 0) {
                        sheetData = data.values; // เก็บข้อมูลทั้งหมดไว้ใน sheetData
    
                        data.values.forEach(row => {
                            const option = document.createElement('option');
                            option.value = row[0]; // ค่าในคอลัมน์ B
                            option.text = row[0];  // ค่าในคอลัมน์ B
                            dropdown.appendChild(option);
                        });
                    }
                })
                .catch(error => {
                    console.error('Error fetching data:', error);
                });
        }
    
        function checkCredentials() {
            const dropdown = document.getElementById('dynamicDropdown');
            const selectedValue = dropdown.value; // ค่าที่เลือกใน dropdown
    
            const passwordInput = document.getElementById('floatingPassword').value; // รหัสผ่านที่ผู้ใช้กรอก
    
            // ตรวจสอบค่าที่เลือกและรหัสผ่าน
            const isValid = sheetData.some(row => row[0] === selectedValue && row[1] === passwordInput);
    
            if (isValid) {
                // เก็บค่า dropdown ที่เลือกไว้ใน Local Storage
                localStorage.setItem('selectedDropdownValue', selectedValue);
    
                // เปลี่ยนหน้าไปที่ pe.html
                window.location.href = 'pe.html';
            } else {
                alert('Invalid credentials. Please try again.');
            }
        }
    
        window.onload = loadDropdownData;


    </script>
    
  
    

    <script src="https://cdn.jsdelivr.net/npm/@Popperjs/core@2.11.8/dist/umd/Popper.min.js"
    integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
    crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
    integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
    crossorigin="anonymous"></script>   
</body>
</html>
